<!-- overall1/send_message.html -->

{% extends 'overall1/base.html' %}

{% block content %}
  <h2>Send Message to {{ recipient.username }}</h2>
  <form id="send-message-form" method="post" action="{% url 'send_message_with_recipient' recipient=recipient.username %}">
    {% csrf_token %}
    {{ form.as_p }}
    
    <!-- Hidden fields for sender and recipient -->
    <input type="hidden" name="sender" value="{{ request.user.username }}">
    <input type="hidden" name="recipient" value="{{ recipient.username }}">

    <button type="submit">Send Message</button>
  </form>

  <script>
    // Auto-populate recipient field on button click
    document.addEventListener('DOMContentLoaded', function () {
      var recipientField = document.querySelector('[name="recipient"]');
      var sendButton = document.querySelector('.send-message-btn');

      sendButton.addEventListener('click', function () {
        recipientField.value = "{{ recipient.username }}";
      });
    });
  </script>
{% endblock %}